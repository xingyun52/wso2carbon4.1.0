PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE
cassandra_hive_table(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value" , "cassandra.cf.name" = "Table" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy", "cassandra.input.split.size" = "64000", "cassandra.range.size" = "100")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE
cassandra_hive_table(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value" , "cassandra.cf.name" = "Table" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy", "cassandra.input.split.size" = "64000", "cassandra.range.size" = "100")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_table
PREHOOK: query: DESCRIBE cassandra_hive_table
PREHOOK: type: DESCTABLE
POSTHOOK: query: DESCRIBE cassandra_hive_table
POSTHOOK: type: DESCTABLE
key	int	from deserializer
value	string	from deserializer
PREHOOK: query: select * from cassandra_hive_table
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-24_578_6024500670688856832/-mr-10000
POSTHOOK: query: select * from cassandra_hive_table
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-24_578_6024500670688856832/-mr-10000
PREHOOK: query: EXPLAIN FROM src INSERT OVERWRITE TABLE cassandra_hive_table SELECT * WHERE (key%7)=0 ORDER BY key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN FROM src INSERT OVERWRITE TABLE cassandra_hive_table SELECT * WHERE (key%7)=0 ORDER BY key
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME cassandra_hive_table))) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (% (TOK_TABLE_OR_COL key) 7) 0)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Map Reduce
      Alias -> Map Operator Tree:
        src 
          TableScan
            alias: src
            Filter Operator
              predicate:
                  expr: ((key % 7) = 0)
                  type: boolean
              Filter Operator
                predicate:
                    expr: ((key % 7) = 0)
                    type: boolean
                Select Operator
                  expressions:
                        expr: key
                        type: string
                        expr: value
                        type: string
                  outputColumnNames: _col0, _col1
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: string
                    sort order: +
                    tag: -1
                    value expressions:
                          expr: _col0
                          type: string
                          expr: _col1
                          type: string
      Reduce Operator Tree:
        Extract
          Select Operator
            expressions:
                  expr: UDFToInteger(_col0)
                  type: int
                  expr: _col1
                  type: string
            outputColumnNames: _col0, _col1
            File Output Operator
              compressed: false
              GlobalTableId: 1
              table:
                  input format: org.apache.hadoop.hive.cassandra.input.HiveCassandraStandardColumnInputFormat
                  output format: org.apache.hadoop.hive.cassandra.output.HiveCassandraOutputFormat
                  serde: org.apache.hadoop.hive.cassandra.serde.CassandraColumnSerDe
                  name: default.cassandra_hive_table


PREHOOK: query: FROM src INSERT OVERWRITE TABLE cassandra_hive_table SELECT * WHERE (key%7)=0 ORDER BY key
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@cassandra_hive_table
POSTHOOK: query: FROM src INSERT OVERWRITE TABLE cassandra_hive_table SELECT * WHERE (key%7)=0 ORDER BY key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@cassandra_hive_table
PREHOOK: query: EXPLAIN select * from cassandra_hive_table
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN select * from cassandra_hive_table
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select * from cassandra_hive_table
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-28_961_7637468109820108023/-mr-10000
POSTHOOK: query: select * from cassandra_hive_table
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-28_961_7637468109820108023/-mr-10000
0	val_0
105	val_105
119	val_119
126	val_126
133	val_133
168	val_168
175	val_175
189	val_189
196	val_196
203	val_203
217	val_217
224	val_224
238	val_238
252	val_252
266	val_266
273	val_273
28	val_28
280	val_280
287	val_287
308	val_308
315	val_315
322	val_322
336	val_336
35	val_35
364	val_364
378	val_378
392	val_392
399	val_399
406	val_406
413	val_413
42	val_42
427	val_427
448	val_448
455	val_455
462	val_462
469	val_469
483	val_483
490	val_490
497	val_497
70	val_70
77	val_77
84	val_84
98	val_98
PREHOOK: query: EXPLAIN select * from cassandra_hive_table ORDER BY key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN select * from cassandra_hive_table ORDER BY key
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        cassandra_hive_table 
          TableScan
            alias: cassandra_hive_table
            Select Operator
              expressions:
                    expr: key
                    type: int
                    expr: value
                    type: string
              outputColumnNames: _col0, _col1
              Reduce Output Operator
                key expressions:
                      expr: _col0
                      type: int
                sort order: +
                tag: -1
                value expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: string
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select * from cassandra_hive_table ORDER BY key
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-29_084_1488034457365154733/-mr-10000
POSTHOOK: query: select * from cassandra_hive_table ORDER BY key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-29_084_1488034457365154733/-mr-10000
0	val_0
28	val_28
35	val_35
42	val_42
70	val_70
77	val_77
84	val_84
98	val_98
105	val_105
119	val_119
126	val_126
133	val_133
168	val_168
175	val_175
189	val_189
196	val_196
203	val_203
217	val_217
224	val_224
238	val_238
252	val_252
266	val_266
273	val_273
280	val_280
287	val_287
308	val_308
315	val_315
322	val_322
336	val_336
364	val_364
378	val_378
392	val_392
399	val_399
406	val_406
413	val_413
427	val_427
448	val_448
455	val_455
462	val_462
469	val_469
483	val_483
490	val_490
497	val_497
PREHOOK: query: EXPLAIN select key from cassandra_hive_table ORDER BY key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN select key from cassandra_hive_table ORDER BY key
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        cassandra_hive_table 
          TableScan
            alias: cassandra_hive_table
            Select Operator
              expressions:
                    expr: key
                    type: int
              outputColumnNames: _col0
              Reduce Output Operator
                key expressions:
                      expr: _col0
                      type: int
                sort order: +
                tag: -1
                value expressions:
                      expr: _col0
                      type: int
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select key from cassandra_hive_table ORDER BY key
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-32_383_8411992301436069433/-mr-10000
POSTHOOK: query: select key from cassandra_hive_table ORDER BY key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-32_383_8411992301436069433/-mr-10000
0
28
35
42
70
77
84
98
105
119
126
133
168
175
189
196
203
217
224
238
252
266
273
280
287
308
315
322
336
364
378
392
399
406
413
427
448
455
462
469
483
490
497
PREHOOK: query: EXPLAIN select value from cassandra_hive_table ORDER BY VALUE
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN select value from cassandra_hive_table ORDER BY VALUE
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL value))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL VALUE)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        cassandra_hive_table 
          TableScan
            alias: cassandra_hive_table
            Select Operator
              expressions:
                    expr: value
                    type: string
              outputColumnNames: _col0
              Reduce Output Operator
                key expressions:
                      expr: _col0
                      type: string
                sort order: +
                tag: -1
                value expressions:
                      expr: _col0
                      type: string
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select value from cassandra_hive_table ORDER BY VALUE
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-36_086_261832610641272207/-mr-10000
POSTHOOK: query: select value from cassandra_hive_table ORDER BY VALUE
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-36_086_261832610641272207/-mr-10000
val_0
val_105
val_119
val_126
val_133
val_168
val_175
val_189
val_196
val_203
val_217
val_224
val_238
val_252
val_266
val_273
val_28
val_280
val_287
val_308
val_315
val_322
val_336
val_35
val_364
val_378
val_392
val_399
val_406
val_413
val_42
val_427
val_448
val_455
val_462
val_469
val_483
val_490
val_497
val_70
val_77
val_84
val_98
PREHOOK: query: EXPLAIN select a.key,a.value,b.value from cassandra_hive_table a JOIN cassandra_hive_table b on a.key=b.key ORDER BY a.key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN select a.key,a.value,b.value from cassandra_hive_table a JOIN cassandra_hive_table b on a.key=b.key ORDER BY a.key
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME cassandra_hive_table) a) (TOK_TABREF (TOK_TABNAME cassandra_hive_table) b) (= (. (TOK_TABLE_OR_COL a) key) (. (TOK_TABLE_OR_COL b) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) value))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL a) key)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: int
              tag: 0
              value expressions:
                    expr: key
                    type: int
                    expr: value
                    type: string
        b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: int
              tag: 1
              value expressions:
                    expr: value
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col5
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col1
                  type: string
                  expr: _col5
                  type: string
            outputColumnNames: _col0, _col1, _col2
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-2
    Map Reduce
      Alias -> Map Operator Tree:
        file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-39_932_1979595607175409115/-mr-10002 
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: int
              sort order: +
              tag: -1
              value expressions:
                    expr: _col0
                    type: int
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select a.key,a.value,b.value from cassandra_hive_table a JOIN cassandra_hive_table b on a.key=b.key ORDER BY a.key
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-40_036_2399994708333554585/-mr-10000
POSTHOOK: query: select a.key,a.value,b.value from cassandra_hive_table a JOIN cassandra_hive_table b on a.key=b.key ORDER BY a.key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-40_036_2399994708333554585/-mr-10000
0	val_0	val_0
28	val_28	val_28
35	val_35	val_35
42	val_42	val_42
70	val_70	val_70
77	val_77	val_77
84	val_84	val_84
98	val_98	val_98
105	val_105	val_105
119	val_119	val_119
126	val_126	val_126
133	val_133	val_133
168	val_168	val_168
175	val_175	val_175
189	val_189	val_189
196	val_196	val_196
203	val_203	val_203
217	val_217	val_217
224	val_224	val_224
238	val_238	val_238
252	val_252	val_252
266	val_266	val_266
273	val_273	val_273
280	val_280	val_280
287	val_287	val_287
308	val_308	val_308
315	val_315	val_315
322	val_322	val_322
336	val_336	val_336
364	val_364	val_364
378	val_378	val_378
392	val_392	val_392
399	val_399	val_399
406	val_406	val_406
413	val_413	val_413
427	val_427	val_427
448	val_448	val_448
455	val_455	val_455
462	val_462	val_462
469	val_469	val_469
483	val_483	val_483
490	val_490	val_490
497	val_497	val_497
PREHOOK: query: EXPLAIN
SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.* FROM src) Y
ON (x.key = Y.key)
ORDER BY key, value LIMIT 20
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.* FROM src) Y
ON (x.key = Y.key)
ORDER BY key, value LIMIT 20
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME cassandra_hive_table)))))) x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME src)))))) Y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL Y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME Y)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL value))) (TOK_LIMIT 20)))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        x:cassandra_hive_table 
          TableScan
            alias: cassandra_hive_table
            Select Operator
              expressions:
                    expr: key
                    type: int
              outputColumnNames: _col0
              Reduce Output Operator
                key expressions:
                      expr: UDFToDouble(_col0)
                      type: double
                sort order: +
                Map-reduce partition columns:
                      expr: UDFToDouble(_col0)
                      type: double
                tag: 0
        y:src 
          TableScan
            alias: src
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
              outputColumnNames: _col0, _col1
              Reduce Output Operator
                key expressions:
                      expr: UDFToDouble(_col0)
                      type: double
                sort order: +
                Map-reduce partition columns:
                      expr: UDFToDouble(_col0)
                      type: double
                tag: 1
                value expressions:
                      expr: _col0
                      type: string
                      expr: _col1
                      type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col2, _col3
          Select Operator
            expressions:
                  expr: _col2
                  type: string
                  expr: _col3
                  type: string
            outputColumnNames: _col0, _col1
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-2
    Map Reduce
      Alias -> Map Operator Tree:
        file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-50_026_980440662900621311/-mr-10002 
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
              sort order: ++
              tag: -1
              value expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
      Reduce Operator Tree:
        Extract
          Limit
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: 20


PREHOOK: query: SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.* FROM src) Y
ON (x.key = Y.key)
ORDER BY key, value LIMIT 20
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Input: default@src
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-50_127_2930084308943323438/-mr-10000
POSTHOOK: query: SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.* FROM src) Y
ON (x.key = Y.key)
ORDER BY key, value LIMIT 20
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-09-50_127_2930084308943323438/-mr-10000
0	val_0
0	val_0
0	val_0
105	val_105
119	val_119
119	val_119
119	val_119
126	val_126
133	val_133
168	val_168
175	val_175
175	val_175
189	val_189
196	val_196
203	val_203
203	val_203
217	val_217
217	val_217
224	val_224
224	val_224
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table2
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table2
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table2(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.cf.name" = "Table2" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table2(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.cf.name" = "Table2" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_table2
PREHOOK: query: EXPLAIN
SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table WHERE cassandra_hive_table.key > 100) x
JOIN
(SELECT cassandra_hive_table2.* FROM cassandra_hive_table2 WHERE cassandra_hive_table2.key < 120) Y
ON (x.key = Y.key)
ORDER BY key, value
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table WHERE cassandra_hive_table.key > 100) x
JOIN
(SELECT cassandra_hive_table2.* FROM cassandra_hive_table2 WHERE cassandra_hive_table2.key < 120) Y
ON (x.key = Y.key)
ORDER BY key, value
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME cassandra_hive_table)))) (TOK_WHERE (> (. (TOK_TABLE_OR_COL cassandra_hive_table) key) 100)))) x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table2))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME cassandra_hive_table2)))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL cassandra_hive_table2) key) 120)))) Y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL Y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME Y)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL value)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        x:cassandra_hive_table 
          TableScan
            alias: cassandra_hive_table
            filterExpr:
                expr: (key > 100)
                type: boolean
            Filter Operator
              predicate:
                  expr: (key > 100)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key > 100)
                    type: boolean
                Select Operator
                  expressions:
                        expr: key
                        type: int
                  outputColumnNames: _col0
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: int
                    sort order: +
                    Map-reduce partition columns:
                          expr: _col0
                          type: int
                    tag: 0
        y:cassandra_hive_table2 
          TableScan
            alias: cassandra_hive_table2
            filterExpr:
                expr: (key < 120)
                type: boolean
            Filter Operator
              predicate:
                  expr: (key < 120)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key < 120)
                    type: boolean
                Select Operator
                  expressions:
                        expr: key
                        type: int
                        expr: value
                        type: string
                  outputColumnNames: _col0, _col1
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: int
                    sort order: +
                    Map-reduce partition columns:
                          expr: _col0
                          type: int
                    tag: 1
                    value expressions:
                          expr: _col0
                          type: int
                          expr: _col1
                          type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col2, _col3
          Select Operator
            expressions:
                  expr: _col2
                  type: int
                  expr: _col3
                  type: string
            outputColumnNames: _col0, _col1
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-2
    Map Reduce
      Alias -> Map Operator Tree:
        file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-09_657_3305388263528414823/-mr-10002 
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: int
                    expr: _col1
                    type: string
              sort order: ++
              tag: -1
              value expressions:
                    expr: _col0
                    type: int
                    expr: _col1
                    type: string
      Reduce Operator Tree:
        Extract
          File Output Operator
            compressed: false
            GlobalTableId: 0
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table WHERE cassandra_hive_table.key > 100) x
JOIN
(SELECT cassandra_hive_table2.* FROM cassandra_hive_table2 WHERE cassandra_hive_table2.key < 120) Y
ON (x.key = Y.key)
ORDER BY key,value
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Input: default@cassandra_hive_table2
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-11_609_2167121634695620439/-mr-10000
POSTHOOK: query: SELECT Y.*
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table WHERE cassandra_hive_table.key > 100) x
JOIN
(SELECT cassandra_hive_table2.* FROM cassandra_hive_table2 WHERE cassandra_hive_table2.key < 120) Y
ON (x.key = Y.key)
ORDER BY key,value
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Input: default@cassandra_hive_table2
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-11_609_2167121634695620439/-mr-10000
PREHOOK: query: DROP TABLE IF EXISTS empty_cassandra_table
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS empty_cassandra_table
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE empty_cassandra_table(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.cf.name" = "emptyTable" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE empty_cassandra_table(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.cf.name" = "emptyTable" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@empty_cassandra_table
PREHOOK: query: DROP TABLE IF EXISTS empty_normal_table
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS empty_normal_table
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE TABLE empty_normal_table(key int, value string)
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE TABLE empty_normal_table(key int, value string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@empty_normal_table
PREHOOK: query: select * from (select count(1) as c from empty_normal_table union all select count(1) as c from empty_cassandra_table) x order by c
PREHOOK: type: QUERY
PREHOOK: Input: default@empty_cassandra_table
PREHOOK: Input: default@empty_normal_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-23_391_1580629861986824261/-mr-10000
POSTHOOK: query: select * from (select count(1) as c from empty_normal_table union all select count(1) as c from empty_cassandra_table) x order by c
POSTHOOK: type: QUERY
POSTHOOK: Input: default@empty_cassandra_table
POSTHOOK: Input: default@empty_normal_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-23_391_1580629861986824261/-mr-10000
0
0
PREHOOK: query: select * from (select count(1) c from empty_normal_table union all select count(1) as c from empty_cassandra_table) x order by c
PREHOOK: type: QUERY
PREHOOK: Input: default@empty_cassandra_table
PREHOOK: Input: default@empty_normal_table
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-40_122_1432392229759568173/-mr-10000
POSTHOOK: query: select * from (select count(1) c from empty_normal_table union all select count(1) as c from empty_cassandra_table) x order by c
POSTHOOK: type: QUERY
POSTHOOK: Input: default@empty_cassandra_table
POSTHOOK: Input: default@empty_normal_table
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-10-40_122_1432392229759568173/-mr-10000
0
0
PREHOOK: query: select * from (select count(1) c from src union all select count(1) as c from empty_cassandra_table) x order by c
PREHOOK: type: QUERY
PREHOOK: Input: default@empty_cassandra_table
PREHOOK: Input: default@src
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-00_401_8488686097830389182/-mr-10000
POSTHOOK: query: select * from (select count(1) c from src union all select count(1) as c from empty_cassandra_table) x order by c
POSTHOOK: type: QUERY
POSTHOOK: Input: default@empty_cassandra_table
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-00_401_8488686097830389182/-mr-10000
0
500
PREHOOK: query: select * from (select count(1) c from src union all select count(1) as c from cassandra_hive_table) x order by c
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Input: default@src
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-14_398_9060309159353861013/-mr-10000
POSTHOOK: query: select * from (select count(1) c from src union all select count(1) as c from cassandra_hive_table) x order by c
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-14_398_9060309159353861013/-mr-10000
43
500
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table3
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table3
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table3(key int, value string, count int)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value,count" , "cassandra.cf.name" = "Table3" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table3(key int, value string, count int)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value,count" , "cassandra.cf.name" = "Table3" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_table3
PREHOOK: query: EXPLAIN
INSERT OVERWRITE TABLE cassandra_hive_table3
SELECT x.key, x.value, Y.count
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.key, count(src.key) as count FROM src GROUP BY src.key) Y
ON (x.key = Y.key)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
INSERT OVERWRITE TABLE cassandra_hive_table3
SELECT x.key, x.value, Y.count
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.key, count(src.key) as count FROM src GROUP BY src.key) Y
ON (x.key = Y.key)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_table))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME cassandra_hive_table)))))) x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key)) (TOK_SELEXPR (TOK_FUNCTION count (. (TOK_TABLE_OR_COL src) key)) count)) (TOK_GROUPBY (. (TOK_TABLE_OR_COL src) key)))) Y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL Y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_TAB (TOK_TABNAME cassandra_hive_table3))) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) key)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL x) value)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL Y) count)))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        y:src 
          TableScan
            alias: src
            Select Operator
              expressions:
                    expr: key
                    type: string
              outputColumnNames: key
              Group By Operator
                aggregations:
                      expr: count(key)
                bucketGroup: false
                keys:
                      expr: key
                      type: string
                mode: hash
                outputColumnNames: _col0, _col1
                Reduce Output Operator
                  key expressions:
                        expr: _col0
                        type: string
                  sort order: +
                  Map-reduce partition columns:
                        expr: _col0
                        type: string
                  tag: -1
                  value expressions:
                        expr: _col1
                        type: bigint
      Reduce Operator Tree:
        Group By Operator
          aggregations:
                expr: count(VALUE._col0)
          bucketGroup: false
          keys:
                expr: KEY._col0
                type: string
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Select Operator
            expressions:
                  expr: _col0
                  type: string
                  expr: _col1
                  type: bigint
            outputColumnNames: _col0, _col1
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat

  Stage: Stage-0
    Map Reduce
      Alias -> Map Operator Tree:
        $INTNAME 
            Reduce Output Operator
              key expressions:
                    expr: UDFToDouble(_col0)
                    type: double
              sort order: +
              Map-reduce partition columns:
                    expr: UDFToDouble(_col0)
                    type: double
              tag: 1
              value expressions:
                    expr: _col1
                    type: bigint
        x:cassandra_hive_table 
          TableScan
            alias: cassandra_hive_table
            Select Operator
              expressions:
                    expr: key
                    type: int
                    expr: value
                    type: string
              outputColumnNames: _col0, _col1
              Reduce Output Operator
                key expressions:
                      expr: UDFToDouble(_col0)
                      type: double
                sort order: +
                Map-reduce partition columns:
                      expr: UDFToDouble(_col0)
                      type: double
                tag: 0
                value expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col3
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col1
                  type: string
                  expr: _col3
                  type: bigint
            outputColumnNames: _col0, _col1, _col2
            Select Operator
              expressions:
                    expr: _col0
                    type: int
                    expr: _col1
                    type: string
                    expr: UDFToInteger(_col2)
                    type: int
              outputColumnNames: _col0, _col1, _col2
              File Output Operator
                compressed: false
                GlobalTableId: 1
                table:
                    input format: org.apache.hadoop.hive.cassandra.input.HiveCassandraStandardColumnInputFormat
                    output format: org.apache.hadoop.hive.cassandra.output.HiveCassandraOutputFormat
                    serde: org.apache.hadoop.hive.cassandra.serde.CassandraColumnSerDe
                    name: default.cassandra_hive_table3


PREHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table3
SELECT x.key, x.value, Y.count
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.key, count(src.key) as count FROM src GROUP BY src.key) Y
ON (x.key = Y.key)
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Input: default@src
PREHOOK: Output: default@cassandra_hive_table3
POSTHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table3
SELECT x.key, x.value, Y.count
FROM
(SELECT cassandra_hive_table.* FROM cassandra_hive_table) x
JOIN
(SELECT src.key, count(src.key) as count FROM src GROUP BY src.key) Y
ON (x.key = Y.key)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Input: default@src
POSTHOOK: Output: default@cassandra_hive_table3
PREHOOK: query: select count(1) from cassandra_hive_table3
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table3
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-50_052_8754633337110023840/-mr-10000
POSTHOOK: query: select count(1) from cassandra_hive_table3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table3
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-50_052_8754633337110023840/-mr-10000
43
PREHOOK: query: select * from cassandra_hive_table3 order by key, value limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table3
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-55_632_356334235472815972/-mr-10000
POSTHOOK: query: select * from cassandra_hive_table3 order by key, value limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table3
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-55_632_356334235472815972/-mr-10000
0	val_0	3
28	val_28	1
35	val_35	3
42	val_42	2
70	val_70	3
PREHOOK: query: select key, count from cassandra_hive_table3 order by key, count desc limit 5
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table3
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-59_216_4942688666050008938/-mr-10000
POSTHOOK: query: select key, count from cassandra_hive_table3 order by key, count desc limit 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table3
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-11-59_216_4942688666050008938/-mr-10000
0	3
28	1
35	3
42	2
70	3
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table4
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table4
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table4(key int, value1 string, value2 int, value3 int)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value1,value2,value3" , "cassandra.cf.name" = "Table4" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table4(key int, value1 string, value2 int, value3 int)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value1,value2,value3" , "cassandra.cf.name" = "Table4" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_table4
PREHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table4 SELECT key, value, key+1, key+2
FROM src WHERE key=98 OR key=100
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@cassandra_hive_table4
POSTHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table4 SELECT key, value, key+1, key+2
FROM src WHERE key=98 OR key=100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@cassandra_hive_table4
PREHOOK: query: SELECT * FROM cassandra_hive_table4 ORDER BY key
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table4
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-12-12_567_7290853941432107675/-mr-10000
POSTHOOK: query: SELECT * FROM cassandra_hive_table4 ORDER BY key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table4
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-12-12_567_7290853941432107675/-mr-10000
98	val_98	99	100
100	val_100	101	102
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table5
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table5
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table5(key int, value map<string,string>)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.cf.name" = "Table5" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table5(key int, value map<string,string>)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.cf.name" = "Table5" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_table5
PREHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table5 SELECT key, map(value, key) FROM src
WHERE key=98 OR key=100
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@cassandra_hive_table5
POSTHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table5 SELECT key, map(value, key) FROM src
WHERE key=98 OR key=100
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@cassandra_hive_table5
PREHOOK: query: SELECT * FROM cassandra_hive_table5 ORDER BY key
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table5
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-12-30_035_7855006066911518083/-mr-10000
POSTHOOK: query: SELECT * FROM cassandra_hive_table5 ORDER BY key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table5
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-12-30_035_7855006066911518083/-mr-10000
98	{"val_98":"98"}
100	{"val_100":"100"}
PREHOOK: query: --Test batch mutation size
DROP TABLE IF EXISTS cassandra_hive_table6
PREHOOK: type: DROPTABLE
POSTHOOK: query: --Test batch mutation size
DROP TABLE IF EXISTS cassandra_hive_table6
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table6(key int, value1 string, value2 int, value3 int, value4 int, value5 String)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value1,value2,value3,value4,value5" ,"cassandra.cf.name" = "Table6" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.batchmutate.size" = "2" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_table6(key int, value1 string, value2 int, value3 int, value4 int, value5 String)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value1,value2,value3,value4,value5" ,"cassandra.cf.name" = "Table6" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9170", "cassandra.batchmutate.size" = "2" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_table6
PREHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table6 SELECT key, value, key+1, key+2, key+3, value
FROM src WHERE (key%21)=0
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@cassandra_hive_table6
POSTHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_table6 SELECT key, value, key+1, key+2, key+3, value
FROM src WHERE (key%21)=0
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@cassandra_hive_table6
PREHOOK: query: SELECT * FROM cassandra_hive_table6 ORDER BY key
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_table6
PREHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-12-37_257_1739139709417092292/-mr-10000
POSTHOOK: query: SELECT * FROM cassandra_hive_table6 ORDER BY key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_table6
POSTHOOK: Output: file:/var/folders/Hh/Hh4JuNM-HoaYIHW5+iNGIE+++TI/-Tmp-/cathy/hive_2011-09-01_14-12-37_257_1739139709417092292/-mr-10000
0	val_0	1	2	3	val_0
42	val_42	43	44	45	val_42
84	val_84	85	86	87	val_84
105	val_105	106	107	108	val_105
126	val_126	127	128	129	val_126
168	val_168	169	170	171	val_168
189	val_189	190	191	192	val_189
252	val_252	253	254	255	val_252
273	val_273	274	275	276	val_273
315	val_315	316	317	318	val_315
336	val_336	337	338	339	val_336
378	val_378	379	380	381	val_378
399	val_399	400	401	402	val_399
462	val_462	463	464	465	val_462
483	val_483	484	485	486	val_483
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_table
PREHOOK: Output: default@cassandra_hive_table
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_table
POSTHOOK: Output: default@cassandra_hive_table
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table2
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_table2
PREHOOK: Output: default@cassandra_hive_table2
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table2
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_table2
POSTHOOK: Output: default@cassandra_hive_table2
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table3
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_table3
PREHOOK: Output: default@cassandra_hive_table3
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table3
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_table3
POSTHOOK: Output: default@cassandra_hive_table3
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table4
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_table4
PREHOOK: Output: default@cassandra_hive_table4
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table4
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_table4
POSTHOOK: Output: default@cassandra_hive_table4
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table5
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_table5
PREHOOK: Output: default@cassandra_hive_table5
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table5
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_table5
POSTHOOK: Output: default@cassandra_hive_table5
PREHOOK: query: DROP TABLE IF EXISTS empty_cassandra_table
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@empty_cassandra_table
PREHOOK: Output: default@empty_cassandra_table
POSTHOOK: query: DROP TABLE IF EXISTS empty_cassandra_table
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@empty_cassandra_table
POSTHOOK: Output: default@empty_cassandra_table
PREHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table6
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_table6
PREHOOK: Output: default@cassandra_hive_table6
POSTHOOK: query: DROP TABLE IF EXISTS cassandra_hive_table6
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_table6
POSTHOOK: Output: default@cassandra_hive_table6
